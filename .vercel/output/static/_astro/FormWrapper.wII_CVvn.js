import{j as e,r as a}from"./react-core.DhkiIPoq.js";const q={success:"bg-green-50 text-green-800 border border-green-200",error:"bg-red-50 text-red-800 border border-red-200",loading:"bg-primary/10 text-primary border border-primary-200"},I={success:"✓",error:"⚠️",loading:""};function j({type:t,children:i,onDismiss:m}){return t==="loading"?e.jsxs("div",{className:"flex items-center justify-center p-4 mb-4",role:"status","aria-live":"polite",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-MainDark"}),e.jsx("span",{className:"ml-3 text-text",children:i})]}):e.jsx("div",{className:`p-4 rounded-lg mb-4 ${q[t]}`,role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"flex-shrink-0","aria-hidden":"true",children:I[t]}),e.jsx("div",{className:"flex-1",children:i})]}),m&&e.jsx("button",{type:"button",onClick:m,className:"flex-shrink-0 ml-4 text-current opacity-50 hover:opacity-100 transition-opacity","aria-label":"Dismiss message",children:"✕"})]})})}function R({children:t,onDismiss:i}){return e.jsx(j,{type:"success",onDismiss:i,children:t})}function U({children:t,onDismiss:i}){return e.jsx(j,{type:"error",onDismiss:i,children:t})}function W({children:t}){return e.jsx(j,{type:"loading",children:t})}const z=a.createContext(null);function H({children:t,onSubmit:i,successMessage:m="Form submitted successfully!",errorMessage:E="An error occurred. Please try again.",loadingMessage:F="Submitting your form...",resetOnSuccess:D=!1,className:k="",onSuccess:A,onError:V}){const[c,S]=a.useState(!1),[h,x]=a.useState("idle"),[b,p]=a.useState(null),[r,g]=a.useState(0),y=a.Children.toArray(t).filter(s=>a.isValidElement(s)&&s.type.displayName==="FormStep"),d=y.length>0,o=d?y.length:1,P=s=>{d&&g(l=>Number.isNaN(s)?l:Math.max(0,Math.min(o-1,s)))},v=()=>{r<o-1&&g(s=>s+1)},N=()=>{r>0&&g(s=>s-1)},L=async s=>{s.preventDefault();const l=s.currentTarget;if(!l.checkValidity()){l.reportValidity();return}const w=new FormData(l);try{S(!0),x("submitting"),p(null);const n={};w.forEach((f,u)=>{const C=w.getAll(u);C.length>1?n[u]=C:l.querySelector(`[name="${u}"][type="checkbox"]`)?n[u]=f==="on":n[u]=f}),await i(n),x("success"),p(m),D&&(l.reset(),g(0)),A?.()}catch(n){x("error");const f=n instanceof Error?n.message:E;p(f),V?.(n instanceof Error?n:new Error("Unknown error"))}finally{S(!1)}},M=()=>{p(null),x("idle")},T=()=>d?y[r]:t,$=a.useMemo(()=>({isMultiStep:d,currentStep:r,totalSteps:o,isFirstStep:r===0,isLastStep:r===o-1,isSubmitting:c,nextStep:v,previousStep:N,goToStep:P}),[r,c,d,o]);return e.jsx(z.Provider,{value:$,children:e.jsxs("form",{onSubmit:L,className:k,noValidate:!1,children:[h==="submitting"&&e.jsx(W,{children:F}),h==="success"&&b&&e.jsx(R,{onDismiss:M,children:b}),h==="error"&&b&&e.jsx(U,{onDismiss:M,children:b}),T(),d&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-6 border-t",children:[r>0?e.jsx("button",{type:"button",onClick:N,disabled:c,className:"px-6 py-2 border border-surface rounded-lg text-text hover:bg-text/5 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}):e.jsx("div",{}),e.jsxs("div",{className:"text-sm text-text",children:["Step ",r+1," of ",o]}),r<o-1?e.jsx("button",{type:"button",onClick:v,disabled:c,className:"px-6 py-2 bg-primary text-bg rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"}):e.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2 bg-green-600 text-bg rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Submitting...":"Submit"})]})]})})}export{H as default};
