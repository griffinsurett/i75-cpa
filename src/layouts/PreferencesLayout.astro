---
// src/layouts/PreferencesLayout.astro
/**
 * Preferences Layout
 *
 * Consolidates all user preference systems:
 * - Cookie consent (with script management)
 * - Accessibility preferences
 * - Language switcher (Google Translate)
 *
 * All use the same lazy-load, zero-impact pattern.
 */

// Cookie Consent Preferences
import CookiePreferencesButton from "@/integrations/preferences/consent/ui/CookiePreferencesButton";
import CookieConsentBanner from "@/integrations/preferences/consent/ui/CookieConsentBanner";
import ConsentScript from "@/integrations/preferences/consent/core/scripts/ConsentScript.astro";

// Accessibility Preferences
import AccessibilityButton from "@/integrations/preferences/accessibility/ui/AccessibilityButton";

// Language Switcher
// import LanguageSwitcher from "@/integrations/preferences/language/ui/LanguageSwitcher";
import BrowserTranslateScript from "@/integrations/preferences/language/core/scripts/BrowserTranslateScript.astro";

import type { ButtonVariant, ButtonSize } from "@/components/Button/Button";

interface Props {
  layout?: "horizontal" | "vertical";
  linkClassName?: string;
  buttonClassName?: string;
  buttonVariant?: ButtonVariant;
  buttonSize?: ButtonSize;
}

const {
  layout = "horizontal",
  linkClassName = "text-bg hover:text-bg",
  buttonClassName = "",
  buttonVariant = "link",
  buttonSize = "sm",
} = Astro.props as Props;

const layoutClasses = {
  horizontal: "flex flex-wrap justify-center items-center gap-3",
  vertical: "flex flex-col items-start gap-3",
};
---

{/* Consent Script - Inline initialization, runs immediately */}
<ConsentScript />

{/* Browser Translation Script - Both native and Google enabled */}
<BrowserTranslateScript enableNative={true} enableGoogle={true} />

<div class={layoutClasses[layout]}>

{/* Language Switcher - Client-side only */}
{/* <LanguageSwitcher client:visible /> */}

{/* CCPA Opt-Out Link */}
<a href="/privacy-policy#ccpa-rights" class={linkClassName}
  >Do Not Sell My Personal Information</a
>

{/* Cookie Preferences Button - Client-side only */}
<CookiePreferencesButton client:visible className={buttonClassName} variant={buttonVariant} size={buttonSize} />
<CookieConsentBanner client:idle />

{/* Accessibility Button - Client-side only */}
<AccessibilityButton client:idle className={buttonClassName} variant={buttonVariant} size={buttonSize} />
</div>
