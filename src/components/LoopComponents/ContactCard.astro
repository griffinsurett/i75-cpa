---
// src/components/LoopComponents/ContactCard.astro
/**
 * Contact Card Component
 *
 * Displays contact information with:
 * - Icon (defaults based on tags: phone, email, or generic)
 * - Title (phone number, email address, etc.)
 * - Optional description
 * - Clickable link if linkPrefix provided
 *
 * Used in ContactVariant to display phone, email, address, etc.
 */

import Icon from "@/components/Icon";
import HighwayCard from "@/components/HighwayCard.astro";

export interface Props {
  title: string; // Label (e.g., "Call Us", "Email Us")
  linkPrefix?: string; // URL prefix (tel:, mailto:, etc.)
  tags?: string[]; // Used to determine default icon
  description?: string; // Contact value (phone digits, email address)
  icon?: any; // Custom icon (overrides default)
  displayValue?: string; // Optional formatted value for UI
  url?: string;
}

const { title, linkPrefix, tags, description, icon, displayValue, url } = Astro.props;

// Smart icon selection based on tags if no custom icon provided
const defaultIcon = tags?.includes("phone")
  ? "lu:phone"
  : tags?.includes("email")
    ? "lu:mail"
    : "lu:contact";

const displayIcon = icon || defaultIcon;

const rawValue = description ?? title ?? "";
const value = displayValue ?? rawValue;
const showLabel = !!description && !!title;

// Build full link if prefix provided (tel:, mailto:, etc.)
const href = url ?? (linkPrefix && rawValue ? `${linkPrefix}${rawValue}` : undefined);
---

<HighwayCard class="bg-primary text-light-primary rounded-2xl shadow-xl ring-2 ring-white/90 border border-white/30 p-6">
  <div class="flex items-center gap-4">
    {/* Icon circle */}
    <div class="flex-shrink-0">
      <Icon icon={displayIcon} size="xl" className="text-white" />
    </div>

    {/* Contact info */}
    <div class="flex-1">
      {/* Title as link or plain text */}
      {/* Label */}
      {showLabel && (
        <p class="text-sm uppercase tracking-wide text-light-primary/80">
          {title}
        </p>
      )}

      {
        href ? (
          <a
            href={href}
            class="text-lg font-semibold text-light-primary hover:text-white transition-colors block"
          >
            {value}
          </a>
        ) : (
          <p class="text-lg font-semibold text-light-primary">{value}</p>
        )
      }
    </div>
  </div>
</HighwayCard>
